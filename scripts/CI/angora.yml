---

build:angora:
  extends: .build
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - ./scripts/build.sh --angora
  artifacts:
    paths:
      - ./*/*/lava-ang
    expire_in: 6 mos
  only:
    - tags

test_seeds:angora:
  extends: .test_seeds
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - ./scripts/build.sh --angora --copy-files
    - ./scripts/test-solution.py -p lava-ang 2/info.yaml 3/info.yaml 4/info.yaml
      5/info.yaml 6/info.yaml 7/info.yaml 8/info.yaml 9/info.yaml 10/info.yaml
      11/info.yaml 12/info.yaml 13/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:2:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 2 -xzf 2/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 2/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:3:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 3 -xzf 3/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 3/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:4:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 4 -xzf 4/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 4/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:5:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 5 -xzf 5/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 5/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:6:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 6 -xzf 6/solutions.tgz
    - (cd 6 && ./patch_solutions.sh )
    - ./scripts/test-solution.py -p lava-ang 6/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:7:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 7 -xzf 7/solutions.tgz
    - (cd 7 && ./patch_solutions.sh )
    - ./scripts/test-solution.py -p lava-ang 7/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:8:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 8 -xzf 8/solutions.tgz
    - (cd 8 && ./patch_solutions.sh )
    - ./scripts/test-solution.py -p lava-ang 8/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:9:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 9 -xzf 9/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 9/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:10:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 10 -xzf 10/solutions.tgz
    - (cd 10 && ./patch_solutions.sh )
    - ./scripts/test-solution.py -p lava-ang 10/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:11:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 11 -xzf 11/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 11/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:12:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 12 -xzf 12/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 12/info.yaml
  dependencies:
    - build:angora
  only:
    - tags

test_solutions:13:13:angora:
  extends: .test_solutions
  image:
    name: registry.gitlab.com/rode0day/fuzzer-testing/angora_runner:16.04
  script:
    - tar -C 13 -xzf 13/solutions.tgz
    - ./scripts/test-solution.py -p lava-ang 13/info.yaml
  dependencies:
    - build:angora
  only:
    - tags
